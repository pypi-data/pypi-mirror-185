<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<style type="text/css">
			@font-face {
				font-family: "Open sans";
				src: local("Open sans"), url("/src/syngen/ml/metrics/accuracy_test/src/fonts/OpenSans-VariableFont.ttf") format("truetype");
			}

			:root {
				--text-color: #1b191b;
				--text-style: normal;
			}

			* {
				margin: 0;
				font-family: "Open sans";
			}

			img {
				margin-bottom: 40px;
				max-width: 745px;
			}

			.container {
				padding: 80px 183px 80px 183px;
			}

			.container--item>img {
				width: 100%;
			}

			.container .container--item {
				margin-bottom: 140px;
			}

			.container .container--item:not(:nth-child(2)) {
				margin-bottom: 100px;
			}

			.anchor {
				font-style: var(--text-style);
				font-weight: 600;
				font-size: 16px;
				line-height: 24px;
				text-align: center;
				text-transform: uppercase;
				margin-bottom: 8px;
				color: var(--text-color);
				text-align: left;
			}

			.anchor:hover {
				color: #008bb5;
				cursor: pointer;
			}

			.accuracy-report-value {
				font-style: var(--text-style);
				font-weight: 400;
				font-size: 20px;
				line-height: 28px;
				color: var(--text-color);
				margin-bottom: 8px;
			}

			.h1-title {
				font-style: var(--text-style);
				font-weight: 700;
				font-size: 40px;
				line-height: 54px;
				color: var(--text-color);
				margin-bottom: 32px;
			}

			.h2-title {
				font-style: var(--text-style);
				font-weight: 600;
				font-size: 32px;
				line-height: 48px;
				color: var(--text-color);
				margin-bottom: 8px;
			}

			.h3-title {
				font-style: var(--text-style);
				font-weight: 600;
				font-size: 16px;
				line-height: 24px;
				text-transform: uppercase;
				color: var(--text-color);
				margin-bottom: 24px;
			}

			.text-description {
				max-width: 745px;
				font-style: var(--text-style);
				font-weight: 400;
				font-size: 14px;
				line-height: 24px;
				color: var(--text-color);
				margin-bottom: 32px;
			}

			.text-description div {
				margin-bottom: 8px;
			}

			.linear-gradient--img {
				max-width: 1000px;
				width: 100%;
				flex-basis: 50%;
				margin-bottom: 32px;
			}

			.linear-gradient--description {
				display: flex;
				max-width: 1000px;
				width: 100%;
			}

			.linear-gradient--description__item {
				width: 25%;
				display: flex;
				justify-content: center;
				align-items: center;
				flex-direction: column;
				margin-bottom: 32px;
			}

			.linear-gradient--description__item div {
				font-style: var(--text-style);
				font-weight: 600;
				font-size: 16px;
				line-height: 24px;
				text-transform: uppercase;
				color: var(--text-color);
			}

			.utility-table table {
				border-spacing: 0;
				margin-bottom: 42px;
				width: 100%;
				max-width: 745px;
				border: none !important;
			}

			.utility-table table thead tr {
				background: #e5e9eb;
				border: none !important;
			}

			.utility-table table thead tr th,
			.utility-table table tbody tr th {
				font-style: var(--text-style);
				font-weight: 600;
				font-size: 13px;
				line-height: 18px;
				text-transform: uppercase;
				color: var(--text-color);
				text-align: left;
				padding: 12px 14px 12px 14px;
				border: none !important;
			}

			.utility-table table thead tr th:last-child {
				text-align: right;
				border: none !important;
			}

			.utility-table table tbody tr td:last-child {
				text-align: right;
				border: none !important;
			}

			.utility-table table tbody tr td {
				font-style: var(--text-style);
				font-weight: 400;
				font-size: 13px;
				line-height: 24px;
				color: var(--text-color);
				padding: 12px 14px 12px 14px;
				border: none !important;
			}

			.utility-table table tbody tr:nth-child(3),
			.utility-table table tbody tr:nth-child(4) {
				background: #f2f4f5;
				border: none !important;
			}

			.bivariate-img-container {
				max-width: 1000px;
				width: 100%;
			}

			.bivariate-img-container--item {
				display: inline-block;
			}

			.bivariate-img-container--item img {
				max-width: 1000px;
				width: 100%;
				background-size: contain;
				background-repeat: no-repeat;
			}

			.bivariate-img-container--item .flex-container {
				display: flex;
				justify-content: space-around;
			}

			.bivariate-img-container--item .flex-container .h3-title {
				display: inline-block;
			}

			.bivariate-title {
				top: 2.5vh;
				position: relative;
				margin-bottom: 0 !important;
			}

			@media print {
				.container {
					padding: 10px;
				}

				.utility-table tbody tr:nth-child(3),
				.utility-table tbody tr:nth-child(4) {
					background: #f2f4f5;
				}
			}

			@media (max-width: 1024px) {
				.container {
					padding: 80px 40px 80px 40px;
				}
			}

		</style>
		<title>Accuracy Report</title>
	</head>

	<body>
		<div class="container">
			<h1 class="h1-title">Accuracy report</h1>
			<div class="container--item">
				<svg class="linear-gradient--img"
					width="1000"
					height="28"
					viewBox="0 0 1000 28"
					fill="none"
					xmlns="http://www.w3.org/2000/svg">
					<g clip-path="url(#clip0_4403_58822)">
						<rect width="1000"
							height="28"
							rx="14"
							transform="matrix(-1 0 0 1 1000 0)"
							fill="url(#paint0_linear_4403_58822)" />
						<line x1="251.5"
							x2="251.5"
							y2="28"
							stroke="white"
							stroke-width="3" />
						<line x1="501.5"
							x2="501.5"
							y2="28"
							stroke="white"
							stroke-width="3" />
						<line x1="751.5"
							x2="751.5"
							y2="28"
							stroke="white"
							stroke-width="3" />
					</g>
					<defs>
						<linearGradient id="paint0_linear_4403_58822"
							x1="1000"
							y1="13.9999"
							x2="5.67408e-06"
							y2="14.0004"
							gradientUnits="userSpaceOnUse">
							<stop stop-color="#CD3D6E" />
							<stop offset="0.2803"
								stop-color="#3E92E0" />
							<stop offset="0.500458"
								stop-color="#78B5EB" />
							<stop offset="0.781743"
								stop-color="#C4E1F9" />
							<stop offset="1"
								stop-color="#E8F4FF" />
						</linearGradient>
						<clipPath id="clip0_4403_58822">
							<rect width="1000"
								height="28"
								rx="14"
								transform="matrix(-1 0 0 1 1000 0)"
								fill="white" />
						</clipPath>
					</defs>
				</svg>

				<div class="linear-gradient--description">
					<div class="linear-gradient--description__item">
						<div>Bad</div>
						<div>
							< 0.7</div>
						</div>

						<div class="linear-gradient--description__item">
							<div>Low</div>
							<div>0.7 - 0.8</div>
						</div>

						<div class="linear-gradient--description__item">
							<div>Medium</div>
							<div>0.8 - 0.9</div>
						</div>

						<div class="linear-gradient--description__item">
							<div>High</div>
							<div> > 0.9</div>
						</div>

					</div>
					<p class="accuracy-report-value">Median accuracy: {{accuracy_value}}</p>
					<p class="accuracy-report-value">Median clusters homogeneity: {{clustering_value}}</p>
				</div>
				<div class="container--item">
					<h2 class="h2-title">Accuracy heatmap</h2>
					<p class="text-description">The accuracy heatmap is calculated in the following way: for each pair of
						original columns a similarity between them (the Jensen-Shannon distance) is measured. The same
						operations is performed on the same pair of columns in the synthetic dataset. The resulting score
						is
						calculated as 1 - abs(original_score - synthetic_score).</p>
					<img src="{{accuracy_heatmap}}">

				</div>
				<div class="container--item">
					<h2 class="h2-title">Content</h2>
					<div class="anchor"
						id="Correlations">Correlations</div>
					<div class="anchor"
						id="Clustering">Clustering</div>
					<div class="anchor"
						id="Utility">Utility</div>
					<div class="anchor"
						id="Univariate">Univariate distributions</div>
					<div class="anchor"
						id="Bivariate">Bivariate distributions</div>
				</div>
				<div class="container--item">
					<h2 class="h2-title"
						id="h2-title--correlations">Correlations</h2>
					<p class="text-description">The correlation metric is calculated in the following manner: for each
						pair
						of
						numeric columns in
						original
						dataset a pairwise correlations is measured thus resulting in the correlations matrix. The same
						operation
						is performed for the synthetic dataset. The resulting matrix is the difference between original
						correlation
						matrix and the synthetic one.</p>
					<img src="{{correlations_heatmap}}">

				</div>
				<div class="container--item">
					<h2 class="h2-title"
						id="h2-title-clustering">Clustering metric</h2>
					<p class="text-description">For clustering metric, both original and synthetic datasets are
						concatenated.
						After this, a
						clustering
						using
						K-means is performed on the concatenated dataset. The optimal number of clusters is chosen using
						the
						elbow
						rule. For the good synthetic data the proportion of original to synthetic records in each cluster
						should be close to 1:1. The mean clusters homogeneity is calculated as a mean of ratios of
						original
						to
						synthetic
						records in each cluster.</p>

					<img src="{{clusters_barplot}}">
					<p>Mean clusters homogeneity: {{clustering_value}}</p>
				</div>

				<div class="container--item">
					<h2 class="h2-title"
						id="h2-title-utility">Utility metric</h2>
					<p class="text-description">For utility calculation an automatic modeling process is engaged. For
						every
						binary, categorical
						and
						continuous
						column it builds a model using given column as a target and other columns as predictors. Then the
						best
						target
						in
						terms of accuracy is chosen. For each of the best targets for different modeling tasks a model is
						trained
						on
						the original dataset, then tested on synthetic one. For the good synthetic data the score of
						model on
						the
						generated
						data should be close to the original one.</p>

					<img src={{utility_barplot}}>
					<h3 class="h3-title">{{table_name}}</h3>
					<div class="utility-table">
						{{utility_table}}
					</div>
				</div>

				<div class="container--item">
					<h2 class="h2-title"
						id="h2-title-univariate">Univariate distributions</h2>
					<p class="text-description">The univariate distributions are either the density plots for original vs
						synthetic values
						overlapped
						for continous columns or barplots for original vs synthetic counts (in percent) for categorical
						columns.
					</p>
					{% for col, uni_img in uni_imgs.items() -%}
					<h3 class="h3-title">{{col}}</h3>
					<img src="{{uni_img}}">
					{% endfor %}
				</div>

				<div class="container--item">
					<h2 class="h2-title"
						id="h2-title-bivariate">Bivariate distributions</h2>
					<p class="text-description">Bivariate distributions are actually the two-dimensional histograms. For
						each
						pair of columns each
						combination
						of their values' levels are plotted as a matrix, thus resulting in a grid. In each cell of this
						grid
						a
						number
						of records belonging to both classes simultaneously is calculated. For instance, for the column
						with
						values "Monday", "Tuesday", "Sunday" and column with values "Working", "Museum visiting" and
						"Walking"
						a count of each activity in each day will be calculated and plotted in the corresponding cell.
						For good synthetic data the pattern of bivariate distribution should match the original
						distribution.
					</p>
					<div class="bivariate-img-container">
						{% for title, bi_img in bi_imgs.items() -%}
						<div class="bivariate-img-container--item">
							<div class="flex-container">
								<h3 class="h3-title bivariate-title">Original: {{title}}</h3>
								<h3 class="h3-title bivariate-title">Synthetics: {{title}}</h3>
							</div>
							<img src="{{bi_img}}">

						</div>
						{% endfor %}
					</div>

				</div>

			</div>
			<script>let scrollTO = (id, scrollToId) =>
					document.getElementById(id).addEventListener("click", () => {
						document.getElementById(scrollToId).scrollIntoView({ behavior: "smooth" });
					});

				scrollTO("Correlations", "h2-title--correlations");
				scrollTO("Clustering", "h2-title-clustering");
				scrollTO("Utility", "h2-title-utility");
				scrollTO("Univariate", "h2-title-univariate");
				scrollTO("Bivariate", "h2-title-bivariate");

			</script>
	</body>

</html>
