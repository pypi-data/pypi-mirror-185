<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Execution plugins &mdash; &#39;Polemarch&#39; 2.3.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/basic.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api.html" />
    <link rel="prev" title="GUI workflow" href="gui.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >
<a href="/#">
<img src="_static/html_logo.png" class="logo" alt="Logo"/>
</a>
  <div class="version">
    2.3.1
  </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui.html">GUI workflow</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Execution plugins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quick-start">Quick start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api-reference">API reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">How to participate</a></li>
<li class="toctree-l1"><a class="reference internal" href="cla.html">VST Consulting contributor agreement</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #343131" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">'Polemarch'</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Execution plugins</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/plugins.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="execution-plugins">
<h1>Execution plugins<a class="headerlink" href="#execution-plugins" title="Permalink to this heading"></a></h1>
<p>Plugins system allows you to execute any external command from Polemarch. To create a plugin you need to</p>
<ul class="simple">
<li><p>create a python class describing the argument processing and API talking logic;</p></li>
<li><p>configure this plugin in your <code class="docutils literal notranslate"><span class="pre">settings.ini</span></code>.</p></li>
</ul>
<div class="section" id="quick-start">
<h2>Quick start<a class="headerlink" href="#quick-start" title="Permalink to this heading"></a></h2>
<p>All built-in execution backends, such as ansible playbook or module execution, use plugins (starting from 2.2.0).</p>
<p>To get started let’s create a simple plugin allows you to run <code class="docutils literal notranslate"><span class="pre">echo</span></code> command.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">polemarch.plugins.base</span> <span class="kn">import</span> <span class="n">BasePlugin</span>
<span class="kn">from</span> <span class="nn">rest_framework.fields</span> <span class="kn">import</span> <span class="n">BooleanField</span><span class="p">,</span> <span class="n">empty</span>
<span class="kn">from</span> <span class="nn">vstutils.api.fields</span> <span class="kn">import</span> <span class="n">VSTCharField</span>


<span class="c1"># Any plugin must be inherited from BasePlugin</span>
<span class="k">class</span> <span class="nc">TestEcho</span><span class="p">(</span><span class="n">BasePlugin</span><span class="p">):</span>
    <span class="c1"># Define fields which will be used to execute this plugin and create template with</span>
    <span class="n">serializer_fields</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># You can use fields either from rest_framework or vstutils</span>
        <span class="s1">&#39;string&#39;</span><span class="p">:</span> <span class="n">VSTCharField</span><span class="p">(),</span>
        <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">empty</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;No trailing newlines&#39;</span><span class="p">),</span>
        <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">empty</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpret backslash escapes&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="c1"># Value of this field will be shown in history detail page as Mode</span>
    <span class="n">arg_shown_on_history_as_mode</span> <span class="o">=</span> <span class="s1">&#39;string&#39;</span>

    <span class="c1"># This is our binary from which any command starts</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">base_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;echo&#39;</span><span class="p">]</span>

    <span class="c1"># This method is called by get_args method of BasePlugin for each argument received from API. As we defined</span>
    <span class="c1"># &#39;string&#39;, &#39;n&#39;, and &#39;e&#39; arguments in serializer_fields, we can get their keys and values here.</span>
    <span class="k">def</span> <span class="nf">_process_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c1"># As &#39;string&#39; argument in this case is a positional argument, let&#39;s return just it&#39;s value, so the final</span>
        <span class="c1"># command will be something like [&#39;echo&#39;, &#39;string to output&#39;, ...]</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="c1"># As this guys are just boolean flags, let&#39;s return them as &#39;-n&#39; or &#39;-e&#39; accordingly</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;-</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="c1"># Note, that if we received for example `n` argument with False value, we are returning None,</span>
        <span class="c1"># means that it won&#39;t be included to execution command. But of course, you may override this behavior</span>
        <span class="c1"># in get_args method.</span>
</pre></div>
</div>
<p>Supposing that described plugin is located at <code class="docutils literal notranslate"><span class="pre">polemarch.plugins.custom.Echo</span></code>, let’s connect it to Polemarch.
In your <code class="docutils literal notranslate"><span class="pre">/etc/polemarch/settings.ini</span></code> add following section:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[plugins.echo]</span>
<span class="na">backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">polemarch.plugins.custom.Echo</span>
</pre></div>
</div>
<p>Also you may want to provide additional options directly to plugin:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[plugins.echo.options]</span>
<span class="na">some_option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;some_option&#39;</span>
</pre></div>
</div>
<p>In this example <cite>some_option</cite> will be available in any plugin’s method as <code class="docutils literal notranslate"><span class="pre">self.config['some_option']</span></code>, as all options are initialized in the constructor.</p>
<p>So it’s all done! After restarting your polemarch server and resetting schema, you can check
<code class="docutils literal notranslate"><span class="pre">/project/&lt;your_project_id&gt;/execute_echo/</span></code>. Here you should be able to execute echo plugin as any built-in one.
Also you should be able to create a <a class="reference internal" href="gui.html#execution-templates"><span class="std std-ref">template</span></a> with it at <code class="docutils literal notranslate"><span class="pre">/project/&lt;your_project_id&gt;/execution_templates/new/</span></code>.</p>
<p>If you tried executing echo plugin with flags, you may see that this flags are being outputted too. This is because
they goes after <code class="docutils literal notranslate"><span class="pre">string</span></code> argument. To fix this issue, we may do something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>

<span class="k">class</span> <span class="nc">TestEcho</span><span class="p">(</span><span class="n">BasePlugin</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="k">def</span> <span class="nf">get_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_args</span><span class="p">):</span>
        <span class="c1"># We know that &#39;string&#39; is required so no default for .pop() is needed</span>
        <span class="n">string_value</span> <span class="o">=</span> <span class="n">raw_args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_args</span><span class="p">(</span><span class="n">raw_args</span><span class="p">)</span>
        <span class="c1"># Push our string to the end of command</span>
        <span class="n">args</span> <span class="o">+=</span> <span class="p">[</span><span class="n">string_value</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">args</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">base_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;echo&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_process_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;-</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
<p>Now if you are passing flags to execution, they should work the same except not being outputted.</p>
<p>To learn more about what plugins are provide, please check API reference.</p>
</div>
<div class="section" id="api-reference">
<h2>API reference<a class="headerlink" href="#api-reference" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">polemarch.plugins.base.</span></span><span class="sig-name descname"><span class="pre">BasePlugin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_handler</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polemarch.plugins.base.BasePlugin" title="Permalink to this definition"></a></dt>
<dd><p>Plugin class from which any other plugin should inherit. The plugin itself is an entity which, on the one hand
provides appropriate fields for the API, and on the other hand, processes arguments received from it to build
execution command.</p>
<p>For each configured plugin an endpoint will be generated allows you to choose arguments and execute it.
Also, this plugin will be available to create template with.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#dict" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">settings.ini</span></code> options mapping for this plugin.</p></li>
<li><p><strong>project_data</strong> – proxy of the project instance, allows you to access it’s readonly properties, such as
<code class="docutils literal notranslate"><span class="pre">config</span></code> <code class="docutils literal notranslate"><span class="pre">vars</span></code>, <code class="docutils literal notranslate"><span class="pre">env_vars</span></code> etc.</p></li>
<li><p><strong>output_handler</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Callable</span></code></a>) – executor’s function which handles logging and outputting to history. Used by
<code class="docutils literal notranslate"><span class="pre">verbose_output</span></code> method.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin._get_serializer_fields">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_get_serializer_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exclude_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polemarch.plugins.base.BasePlugin._get_serializer_fields" title="Permalink to this definition"></a></dt>
<dd><p>Returns dict with field names and field instances used to generate fields for serializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>exclude_fields</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – field names that should not be presented in serializer.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#dict" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin._get_serializer_metaclass">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_get_serializer_metaclass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exclude_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polemarch.plugins.base.BasePlugin._get_serializer_metaclass" title="Permalink to this definition"></a></dt>
<dd><p>Returns serializer metaclass used to generate fields in serializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>exclude_fields</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – field names that should not be presented in serializer.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Type" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Type</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Type" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Type</span></code></a>[<a class="reference external" href="https://vstutils.vstconsulting.net/en/stable/backend.html#vstutils.api.serializers.BaseSerializer" title="(in VST Utils v5.2.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">vstutils.api.serializers.BaseSerializer</span></code></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin._process_arg">
<span class="sig-name descname"><span class="pre">_process_arg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polemarch.plugins.base.BasePlugin._process_arg" title="Permalink to this definition"></a></dt>
<dd><p>Returns single argument with value for <code class="docutils literal notranslate"><span class="pre">get_args</span></code> method. Should return <code class="docutils literal notranslate"><span class="pre">None</span></code> if argument must not be
included to the execution command.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – argument key (e.g. <cite>verbose</cite>).</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Any</span></code></a>) – argument value (e.g. <cite>2</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.arg_shown_on_history_as_mode">
<span class="sig-name descname"><span class="pre">arg_shown_on_history_as_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.arg_shown_on_history_as_mode" title="Permalink to this definition"></a></dt>
<dd><p>Name of argument presented in generated serializer which will be shown on detail history page as <em>Mode</em>. For
example, if you are executing some module with additional arguments and fields contains <cite>module</cite> field, than you
can set <cite>‘module’</cite> here, and it’s value will be shown after execution. If not set, <em>Mode</em> in the history will show
<code class="docutils literal notranslate"><span class="pre">[&lt;plugin</span> <span class="pre">name&gt;</span> <span class="pre">plugin]</span></code> string.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.base_command">
<span class="sig-name descname"><span class="pre">base_command</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.List" title="(in Python v3.6)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.base_command" title="Permalink to this definition"></a></dt>
<dd><p>Base command (usually binary) from which execution command starts, e.g. <code class="docutils literal notranslate"><span class="pre">['echo']</span></code>. You may also override this
attribute as a property if more complex logic needs to be performed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.error_codes">
<span class="sig-name descname"><span class="pre">error_codes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><span class="pre">Mapping</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.error_codes" title="Permalink to this definition"></a></dt>
<dd><p>This mapping will be looked up to choose an appropriate error message for history output if execution finished with
errors. If no code found, then just “ERROR” string outputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.get_args">
<span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.get_args" title="Permalink to this definition"></a></dt>
<dd><p>Returns list of processed arguments which will be substituted into execution command.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raw_args</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#dict" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – argument name-value mapping which should be processed.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.List" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.List</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.get_env_vars">
<span class="sig-name descname"><span class="pre">get_env_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.get_env_vars" title="Permalink to this definition"></a></dt>
<dd><p>Returns env variables which will be used in execution, project’s env variables by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.get_execution_data">
<span class="sig-name descname"><span class="pre">get_execution_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">execution_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.get_execution_data" title="Permalink to this definition"></a></dt>
<dd><p>Returns tuple of execution command, env variables and raw inventory string. This method will be called directly
by executor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>execution_dir</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/pathlib.html#pathlib.Path" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>) – path to execution directory in which project copy located. All additional files that
should be generated (e.g. inventory file) must be placed here.</p></li>
<li><p><strong>raw_args</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#dict" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – argument name-value mapping which should be processed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Tuple" title="(in Python v3.6)"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.List" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.List</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], <a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#dict" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.get_inventory">
<span class="sig-name descname"><span class="pre">get_inventory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inventory</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.get_inventory" title="Permalink to this definition"></a></dt>
<dd><p>Returns tuple of inventory argument for execution command and raw inventory string used
for representation in history. If no inventory presented, should return <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">'')</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inventory</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Union" title="(in Python v3.6)"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Union</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">polemarch.main.models.hosts.Inventory</span></code>, <a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]) – inventory, received from API, which can <code class="docutils literal notranslate"><span class="pre">None</span></code> if there is no inventory,
<code class="docutils literal notranslate"><span class="pre">polemarch.main.models.Inventory</span></code> instance, int or str.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Tuple" title="(in Python v3.6)"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], <a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.get_serializer_class">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_serializer_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exclude_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.get_serializer_class" title="Permalink to this definition"></a></dt>
<dd><p>Returns serializer class which will be used to generate fields for arguments. Uses metaclass returned by
<code class="docutils literal notranslate"><span class="pre">_get_serializer_metaclass</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>exclude_fields</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – field names that should not be presented in serializer.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Type" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Type</span></code></a>[<a class="reference external" href="https://vstutils.vstconsulting.net/en/stable/backend.html#vstutils.api.serializers.BaseSerializer" title="(in VST Utils v5.2.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">vstutils.api.serializers.BaseSerializer</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.get_verbose_level">
<span class="sig-name descname"><span class="pre">get_verbose_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.get_verbose_level" title="Permalink to this definition"></a></dt>
<dd><p>Returns verbose level used for history output and logging. Should be taken from execution arguments (usually
from <code class="docutils literal notranslate"><span class="pre">verbose</span></code> argument). This method will be called directly by executor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raw_args</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#dict" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – argument name-value mapping which should be processed.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.inventory_filename">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inventory_filename</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a></em><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.inventory_filename" title="Permalink to this definition"></a></dt>
<dd><p>Returns name of file with inventory content.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.prepare_execution_dir">
<span class="sig-name descname"><span class="pre">prepare_execution_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.prepare_execution_dir" title="Permalink to this definition"></a></dt>
<dd><p>Gets execution directory with copied project. All files needed for execution (e.g. generated inventory file)
should be here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dir</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/pathlib.html#pathlib.Path" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>) – path to execution directory in which project copy located. All additional files that
should be generated (e.g. inventory file) must be placed here.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.serializer_fields">
<span class="sig-name descname"><span class="pre">serializer_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><span class="pre">Mapping</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Field</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.serializer_fields" title="Permalink to this definition"></a></dt>
<dd><p>Fields mapping used to generate serializer. By default returned by <code class="docutils literal notranslate"><span class="pre">_get_serializer_fields</span></code> method.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.supports_inventory">
<span class="sig-name descname"><span class="pre">supports_inventory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.supports_inventory" title="Permalink to this definition"></a></dt>
<dd><p>Flag shows if the plugin supports working with inventory. For now it’s only used to show or hide inventory field
in execution template create page.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polemarch.plugins.base.BasePlugin.verbose_output">
<span class="sig-name descname"><span class="pre">verbose_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#polemarch.plugins.base.BasePlugin.verbose_output" title="Permalink to this definition"></a></dt>
<dd><p>Logs value with logger and outputs it to history.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – message to output.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – verbosity level from which message should be outputted.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gui.html" class="btn btn-neutral float-left" title="GUI workflow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright VST Consulting, 2019-2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>